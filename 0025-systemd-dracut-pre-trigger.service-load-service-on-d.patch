From f251a89772e68ddc057439ea8ee338ee99853833 Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Fri, 8 Feb 2013 14:17:50 +0100
Subject: [PATCH] systemd/dracut-pre-trigger.service: load service on demand

---
 modules.d/98systemd/dracut-pre-trigger.service | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/modules.d/98systemd/dracut-pre-trigger.service b/modules.d/98systemd/dracut-pre-trigger.service
index 6836d89..55c9938 100644
--- a/modules.d/98systemd/dracut-pre-trigger.service
+++ b/modules.d/98systemd/dracut-pre-trigger.service
@@ -15,6 +15,8 @@ Before=systemd-udev-trigger.service dracut-initqueue.service
 After=dracut-pre-udev.service systemd-udevd.service
 Wants=dracut-pre-udev.service systemd-udevd.service
 ConditionPathExists=/etc/initrd-release
+ConditionDirectoryNotEmpty=|/lib/dracut/hooks/pre-trigger
+ConditionKernelCommandLine=|rd.break=pre-trigger
 
 [Service]
 Type=oneshot
