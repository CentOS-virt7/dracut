From 2cae00be9ec7a9ba8538e24d53236a8baa34c93f Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Wed, 26 Sep 2012 11:34:00 +0200
Subject: [PATCH] busybox/module-setup.sh: generate nice relative symlinks
 with ln_r

---
 modules.d/05busybox/module-setup.sh | 8 ++------
 1 file changed, 2 insertions(+), 6 deletions(-)

diff --git a/modules.d/05busybox/module-setup.sh b/modules.d/05busybox/module-setup.sh
index e0ef178..edcc8da 100755
--- a/modules.d/05busybox/module-setup.sh
+++ b/modules.d/05busybox/module-setup.sh
@@ -16,7 +16,7 @@ install() {
     local _i _progs _path _busybox
     _busybox=$(type -P busybox)
     inst $_busybox /usr/bin/busybox
-    for _i in `$_busybox | sed -ne '1,/Currently/!{s/,//g; s/busybox//g; p}'`
+    for _i in $($_busybox | sed -ne '1,/Currently/!{s/,//g; s/busybox//g; p}')
     do
         _progs="$_progs $_i"
     done
@@ -27,11 +27,7 @@ install() {
     for _i in $_progs; do
         _path=$(find_binary "$_i")
         [ -z "$_path" ] && continue
-        if [[ $_path != ${_path#/usr} ]]; then
-            ln -sf ../../usr/bin/busybox "$initdir/$_path"
-        else
-            ln -sf ../usr/bin/busybox "$initdir/$_path"
-        fi
+        ln_r /usr/bin/busybox $_path
     done
 }
 
