From cad10a7f8043752bb0c8d411ee7a30c641d6622c Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Wed, 9 May 2012 11:42:39 +0200
Subject: [PATCH] base/init.sh: set DRACUT_QUIET only in dracut-lib.sh

---
 modules.d/99base/dracut-lib.sh |    3 +++
 modules.d/99base/init.sh       |    6 ------
 2 Dateien geändert, 3 Zeilen hinzugefügt(+), 6 Zeilen entfernt(-)

diff --git a/modules.d/99base/dracut-lib.sh b/modules.d/99base/dracut-lib.sh
index ddb6954..e46e456 100755
--- a/modules.d/99base/dracut-lib.sh
+++ b/modules.d/99base/dracut-lib.sh
@@ -316,6 +316,9 @@ check_quiet() {
         getargbool 0 rd.info -y rdinfo && DRACUT_QUIET="no"
         getargbool 0 rd.debug -y rdinitdebug && DRACUT_QUIET="no"
         getarg quiet || DRACUT_QUIET="yes"
+        a=$(getarg loglevel=)
+        [ -n "$a" ] && [ $a -ge 28 ] && DRACUT_QUIET="yes"
+        export DRACUT_QUIET
     fi
 }
 
diff --git a/modules.d/99base/init.sh b/modules.d/99base/init.sh
index cba2e1a..5807b12 100755
--- a/modules.d/99base/init.sh
+++ b/modules.d/99base/init.sh
@@ -39,12 +39,6 @@ fi
 
 setdebug
 
-if [ "$RD_DEBUG" = "yes" ]; then
-    getarg quiet && DRACUT_QUIET="yes"
-    a=$(getarg loglevel=)
-    [ -n "$a" ] && [ $a -ge 8 ] && unset DRACUT_QUIET
-fi
-
 if ! ismounted /dev; then
     mount -t devtmpfs -o mode=0755,nosuid,strictatime devtmpfs /dev >/dev/null 
 fi
