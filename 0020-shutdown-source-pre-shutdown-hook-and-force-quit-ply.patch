From 54e0205ea205839a743803dce86d672f62d657c4 Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Fri, 18 Jan 2013 11:00:48 +0100
Subject: [PATCH] shutdown: source pre-shutdown hook and force quit plymouth
 before umount

---
 modules.d/99shutdown/shutdown.sh | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/modules.d/99shutdown/shutdown.sh b/modules.d/99shutdown/shutdown.sh
index 1a6ac31..acd3bfe 100755
--- a/modules.d/99shutdown/shutdown.sh
+++ b/modules.d/99shutdown/shutdown.sh
@@ -24,6 +24,10 @@ fi
 trap "emergency_shell --shutdown shutdown Signal caught!" 0
 getarg 'rd.break=pre-shutdown' && emergency_shell --shutdown pre-shutdown "Break before pre-shutdown"
 
+source_hook pre-shutdown
+
+/bin/plymouth --quit || /oldroot/bin/plymouth --quit
+
 umount_a() {
     local _did_umount="n"
     while read a mp a; do
