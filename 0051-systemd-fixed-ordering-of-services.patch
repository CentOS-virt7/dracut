From b03e991113f7e33c0fd072e16d4ebd862542e720 Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Thu, 21 Jun 2012 01:08:03 +0200
Subject: [PATCH] systemd: fixed ordering of services

---
 modules.d/98systemd/dracut-initqueue.service   |    3 ++-
 modules.d/98systemd/dracut-pre-trigger.service |    5 +++--
 modules.d/98systemd/dracut-pre-udev.service    |    4 +++-
 3 files changed, 8 insertions(+), 4 deletions(-)

diff --git a/modules.d/98systemd/dracut-initqueue.service b/modules.d/98systemd/dracut-initqueue.service
index c87e6a0..89aa304 100644
--- a/modules.d/98systemd/dracut-initqueue.service
+++ b/modules.d/98systemd/dracut-initqueue.service
@@ -10,7 +10,8 @@
 [Unit]
 Description=Dracut initqueue hook
 DefaultDependencies=no
-After=systemd-udev-trigger.service
+After=systemd-udev-trigger.service udev-trigger.service
+Wants=systemd-udev-trigger.service udev-trigger.service
 
 [Service]
 Environment=HOME=/
diff --git a/modules.d/98systemd/dracut-pre-trigger.service b/modules.d/98systemd/dracut-pre-trigger.service
index 18eb8fc..1ab07a1 100644
--- a/modules.d/98systemd/dracut-pre-trigger.service
+++ b/modules.d/98systemd/dracut-pre-trigger.service
@@ -10,8 +10,9 @@
 [Unit]
 Description=Dracut pre-trigger hook
 DefaultDependencies=no
-After=systemd-udev.service
-Before=systemd-udev-trigger.service
+Before=systemd-udev-trigger.service udev-trigger.service dracut-initqueue.service
+After=dracut-pre-udev.service systemd-udev.service udev.service
+Wants=dracut-pre-udev.service systemd-udev.service udev.service
 
 [Service]
 Environment=HOME=/
diff --git a/modules.d/98systemd/dracut-pre-udev.service b/modules.d/98systemd/dracut-pre-udev.service
index 9b2d929..579316e 100644
--- a/modules.d/98systemd/dracut-pre-udev.service
+++ b/modules.d/98systemd/dracut-pre-udev.service
@@ -10,7 +10,9 @@
 [Unit]
 Description=Dracut pre-udev hook
 DefaultDependencies=no
-Before=systemd-udev.service
+Before=systemd-udev.service udev.service dracut-pre-trigger.service
+After=dracut-cmdline.service
+Wants=dracut-cmdline.service
 
 [Service]
 Environment=HOME=/
