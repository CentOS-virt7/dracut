From 6320d072a138afe7b7150e51240803b52d734ea4 Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Tue, 5 Feb 2013 10:56:13 +0100
Subject: [PATCH] mdmon: renamed mdmon-offroot@.service to mdmon@.service

---
 dracut.spec                        | 2 ++
 modules.d/90mdraid/module-setup.sh | 4 ++--
 2 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/dracut.spec b/dracut.spec
index 82ba772..22f3366 100644
--- a/dracut.spec
+++ b/dracut.spec
@@ -96,6 +96,8 @@ Conflicts: initscripts < 8.63-1
 Conflicts: plymouth < 0.8.0-0.2009.29.09.19.1
 %endif
 
+Conflicts: mdadm < 3.2.6-14
+
 %description
 dracut contains tools to create a bootable initramfs for 2.6 Linux kernels.
 Unlike existing implementations, dracut does hard-code as little as possible
diff --git a/modules.d/90mdraid/module-setup.sh b/modules.d/90mdraid/module-setup.sh
index 3b5620c..3824f40 100755
--- a/modules.d/90mdraid/module-setup.sh
+++ b/modules.d/90mdraid/module-setup.sh
@@ -88,8 +88,8 @@ install() {
     inst_hook shutdown 30 "$moddir/md-shutdown.sh"
     inst_script "$moddir/mdraid-cleanup.sh" /sbin/mdraid-cleanup
     inst_script "$moddir/mdraid_start.sh" /sbin/mdraid_start
-    if [ -e /lib/systemd/system/mdmon-offroot@.service ]; then
-        inst_simple /lib/systemd/system/mdmon-offroot@.service
+    if [ -e /lib/systemd/system/mdmon@.service ]; then
+        inst_simple /lib/systemd/system/mdmon@.service
     fi
     inst_hook pre-shutdown 30 "$moddir/mdmon-pre-shutdown.sh"
 }
