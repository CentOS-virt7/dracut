From edcbd379d50218695681e9bb13288f9603da04f6 Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Thu, 21 Jun 2012 01:04:15 +0200
Subject: [PATCH] systemd/dracut-pre-pivot.sh: stop old udev services

---
 modules.d/98systemd/dracut-pre-pivot.sh |    6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/modules.d/98systemd/dracut-pre-pivot.sh b/modules.d/98systemd/dracut-pre-pivot.sh
index eb7e932..6685210 100755
--- a/modules.d/98systemd/dracut-pre-pivot.sh
+++ b/modules.d/98systemd/dracut-pre-pivot.sh
@@ -34,7 +34,11 @@ done
 echo "NEWROOT=\"$NEWROOT\"" >> /run/initramfs/switch-root.conf
 
 udevadm control --stop-exec-queue
-systemctl stop systemd-udev.service
+
+for i in systemd-udev.service udev.service; do
+    systemctl is-active $i >/dev/null 2>&1 && systemctl stop $i
+done
+
 udevadm info --cleanup-db
 
 # remove helper symlink
