From 0fc0dcff60de5d903985944d760d53c093f6687f Mon Sep 17 00:00:00 2001
From: Harald Hoyer <harald@redhat.com>
Date: Tue, 18 Sep 2012 13:39:54 +0200
Subject: [PATCH] bye bye iscsi_wait_scan ... officially gone for kernel 3.6

---
 modules.d/01fips/fips.sh                | 2 --
 modules.d/01fips/module-setup.sh        | 1 -
 modules.d/98systemd/dracut-initqueue.sh | 1 -
 modules.d/99base/init.sh                | 1 -
 4 files changed, 5 deletions(-)

diff --git a/modules.d/01fips/fips.sh b/modules.d/01fips/fips.sh
index 324e062..48ad0e6 100755
--- a/modules.d/01fips/fips.sh
+++ b/modules.d/01fips/fips.sh
@@ -32,8 +32,6 @@ mount_boot()
                     udevadm settle --timeout=30
                 fi
                 [ -e $boot ] && break
-                modprobe scsi_wait_scan && rmmod scsi_wait_scan
-                [ -e $boot ] && break
                 sleep 0.5
                 i=$(($i+1))
                 [ $i -gt 40 ] && break
diff --git a/modules.d/01fips/module-setup.sh b/modules.d/01fips/module-setup.sh
index 103a479..6b3e444 100755
--- a/modules.d/01fips/module-setup.sh
+++ b/modules.d/01fips/module-setup.sh
@@ -24,7 +24,6 @@ installkernel() {
             echo "blacklist $_mod" >> "${initdir}/etc/modprobe.d/fips.conf"
         fi
     done
-    hostonly='' instmods scsi_wait_scan
 }
 
 install() {
diff --git a/modules.d/98systemd/dracut-initqueue.sh b/modules.d/98systemd/dracut-initqueue.sh
index 773e4cd..e9da432 100755
--- a/modules.d/98systemd/dracut-initqueue.sh
+++ b/modules.d/98systemd/dracut-initqueue.sh
@@ -25,7 +25,6 @@ while :; do
     check_finished && break
 
     udevsettle
-    modprobe -q scsi_wait_scan && modprobe -q -r scsi_wait_scan
 
     check_finished && break
 
diff --git a/modules.d/99base/init.sh b/modules.d/99base/init.sh
index 4c5a2f8..16c8958 100755
--- a/modules.d/99base/init.sh
+++ b/modules.d/99base/init.sh
@@ -156,7 +156,6 @@ while :; do
     check_finished && break
 
     udevsettle
-    modprobe -q scsi_wait_scan && modprobe -q -r scsi_wait_scan
 
     check_finished && break
 
